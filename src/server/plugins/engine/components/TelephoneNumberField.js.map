{"version":3,"file":"TelephoneNumberField.js","names":["joi","FormComponent","addClassOptionIfNone","PATTERN","TelephoneNumberField","constructor","def","props","options","title","formSchema","string","trim","pattern","label","toLowerCase","required","allow","customValidationMessage","message","messages","customValidationMessages","default","stateSchema","getViewModel","payload","errors","viewModel","attributes","autocomplete","type"],"sources":["../../../../../src/server/plugins/engine/components/TelephoneNumberField.ts"],"sourcesContent":["import { type TelephoneNumberFieldComponent } from '@defra/forms-model'\nimport joi, { type StringSchema } from 'joi'\n\nimport { FormComponent } from '~/src/server/plugins/engine/components/FormComponent.js'\nimport { addClassOptionIfNone } from '~/src/server/plugins/engine/components/helpers.js'\nimport {\n  type FormPayload,\n  type FormSubmissionError\n} from '~/src/server/plugins/engine/types.js'\n\nconst PATTERN = /^[0-9\\\\\\s+()-]*$/\n\nexport class TelephoneNumberField extends FormComponent {\n  declare options: TelephoneNumberFieldComponent['options']\n  declare formSchema: StringSchema\n  declare stateSchema: StringSchema\n\n  constructor(\n    def: TelephoneNumberFieldComponent,\n    props: ConstructorParameters<typeof FormComponent>[1]\n  ) {\n    super(def, props)\n\n    const { options, title } = def\n\n    let formSchema = joi\n      .string()\n      .trim()\n      .pattern(PATTERN)\n      .label(title.toLowerCase())\n      .required()\n\n    if (options.required === false) {\n      formSchema = formSchema.allow('')\n    }\n\n    if (options.customValidationMessage) {\n      const message = options.customValidationMessage\n\n      formSchema = formSchema.messages({\n        'any.required': message,\n        'string.empty': message,\n        'string.pattern.base': message\n      })\n    } else if (options.customValidationMessages) {\n      formSchema = formSchema.messages(options.customValidationMessages)\n    }\n\n    addClassOptionIfNone(options, 'govuk-input--width-20')\n\n    this.formSchema = formSchema.default('')\n    this.stateSchema = formSchema.default(null).allow(null)\n    this.options = options\n  }\n\n  getViewModel(payload: FormPayload, errors?: FormSubmissionError[]) {\n    const viewModel = super.getViewModel(payload, errors)\n    const { attributes } = viewModel\n\n    attributes.autocomplete = 'tel'\n\n    return {\n      ...viewModel,\n      type: 'tel'\n    }\n  }\n}\n"],"mappings":"AACA,OAAOA,GAAG,MAA6B,KAAK;AAE5C,SAASC,aAAa;AACtB,SAASC,oBAAoB;AAM7B,MAAMC,OAAO,GAAG,kBAAkB;AAElC,OAAO,MAAMC,oBAAoB,SAASH,aAAa,CAAC;EAKtDI,WAAWA,CACTC,GAAkC,EAClCC,KAAqD,EACrD;IACA,KAAK,CAACD,GAAG,EAAEC,KAAK,CAAC;IAEjB,MAAM;MAAEC,OAAO;MAAEC;IAAM,CAAC,GAAGH,GAAG;IAE9B,IAAII,UAAU,GAAGV,GAAG,CACjBW,MAAM,CAAC,CAAC,CACRC,IAAI,CAAC,CAAC,CACNC,OAAO,CAACV,OAAO,CAAC,CAChBW,KAAK,CAACL,KAAK,CAACM,WAAW,CAAC,CAAC,CAAC,CAC1BC,QAAQ,CAAC,CAAC;IAEb,IAAIR,OAAO,CAACQ,QAAQ,KAAK,KAAK,EAAE;MAC9BN,UAAU,GAAGA,UAAU,CAACO,KAAK,CAAC,EAAE,CAAC;IACnC;IAEA,IAAIT,OAAO,CAACU,uBAAuB,EAAE;MACnC,MAAMC,OAAO,GAAGX,OAAO,CAACU,uBAAuB;MAE/CR,UAAU,GAAGA,UAAU,CAACU,QAAQ,CAAC;QAC/B,cAAc,EAAED,OAAO;QACvB,cAAc,EAAEA,OAAO;QACvB,qBAAqB,EAAEA;MACzB,CAAC,CAAC;IACJ,CAAC,MAAM,IAAIX,OAAO,CAACa,wBAAwB,EAAE;MAC3CX,UAAU,GAAGA,UAAU,CAACU,QAAQ,CAACZ,OAAO,CAACa,wBAAwB,CAAC;IACpE;IAEAnB,oBAAoB,CAACM,OAAO,EAAE,uBAAuB,CAAC;IAEtD,IAAI,CAACE,UAAU,GAAGA,UAAU,CAACY,OAAO,CAAC,EAAE,CAAC;IACxC,IAAI,CAACC,WAAW,GAAGb,UAAU,CAACY,OAAO,CAAC,IAAI,CAAC,CAACL,KAAK,CAAC,IAAI,CAAC;IACvD,IAAI,CAACT,OAAO,GAAGA,OAAO;EACxB;EAEAgB,YAAYA,CAACC,OAAoB,EAAEC,MAA8B,EAAE;IACjE,MAAMC,SAAS,GAAG,KAAK,CAACH,YAAY,CAACC,OAAO,EAAEC,MAAM,CAAC;IACrD,MAAM;MAAEE;IAAW,CAAC,GAAGD,SAAS;IAEhCC,UAAU,CAACC,YAAY,GAAG,KAAK;IAE/B,OAAO;MACL,GAAGF,SAAS;MACZG,IAAI,EAAE;IACR,CAAC;EACH;AACF","ignoreList":[]}