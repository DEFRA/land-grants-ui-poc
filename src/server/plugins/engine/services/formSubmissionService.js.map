{"version":3,"file":"formSubmissionService.js","names":["config","postJson","submissionUrl","get","persistFiles","files","persistedRetrievalKey","postJsonByType","payload","result","submit","data"],"sources":["../../../../../src/server/plugins/engine/services/formSubmissionService.js"],"sourcesContent":["import { config } from '~/src/config/index.js'\nimport { postJson } from '~/src/server/services/httpService.js'\n\nconst submissionUrl = config.get('submissionUrl')\n\n/**\n * Persist files by extending the time-to-live to 30 days\n * @param {{fileId: string, initiatedRetrievalKey: string}[]} files - batch of files to persist\n * @param {string} persistedRetrievalKey - final retrieval key when submitting\n */\nexport async function persistFiles(files, persistedRetrievalKey) {\n  const postJsonByType = /** @type {typeof postJson} */ (postJson)\n\n  const payload = {\n    files,\n    persistedRetrievalKey\n  }\n\n  const result = await postJsonByType(`${submissionUrl}/files/persist`, {\n    payload\n  })\n\n  return result\n}\n\n/**\n * Submit form\n * @param {SubmitPayload} data - submission data\n */\nexport async function submit(data) {\n  const postJsonByType = /** @type {typeof postJson<SubmitResponsePayload>} */ (\n    postJson\n  )\n\n  const payload = data\n\n  const result = await postJsonByType(`${submissionUrl}/submit`, {\n    payload\n  })\n\n  return result.payload\n}\n\n/**\n * @import { SubmitPayload, SubmitResponsePayload } from '@defra/forms-model'\n */\n"],"mappings":"AAAA,SAASA,MAAM;AACf,SAASC,QAAQ;AAEjB,MAAMC,aAAa,GAAGF,MAAM,CAACG,GAAG,CAAC,eAAe,CAAC;;AAEjD;AACA;AACA;AACA;AACA;AACA,OAAO,eAAeC,YAAYA,CAACC,KAAK,EAAEC,qBAAqB,EAAE;EAC/D,MAAMC,cAAc,GAAG,8BAAgCN,QAAS;EAEhE,MAAMO,OAAO,GAAG;IACdH,KAAK;IACLC;EACF,CAAC;EAED,MAAMG,MAAM,GAAG,MAAMF,cAAc,CAAC,GAAGL,aAAa,gBAAgB,EAAE;IACpEM;EACF,CAAC,CAAC;EAEF,OAAOC,MAAM;AACf;;AAEA;AACA;AACA;AACA;AACA,OAAO,eAAeC,MAAMA,CAACC,IAAI,EAAE;EACjC,MAAMJ,cAAc,GAAG;EACrBN,QACD;EAED,MAAMO,OAAO,GAAGG,IAAI;EAEpB,MAAMF,MAAM,GAAG,MAAMF,cAAc,CAAC,GAAGL,aAAa,SAAS,EAAE;IAC7DM;EACF,CAAC,CAAC;EAEF,OAAOC,MAAM,CAACD,OAAO;AACvB;;AAEA;AACA;AACA","ignoreList":[]}