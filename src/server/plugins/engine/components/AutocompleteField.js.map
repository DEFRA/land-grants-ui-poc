{"version":3,"file":"AutocompleteField.js","names":["SelectField","messageTemplate","AutocompleteField","constructor","def","props","options","formSchema","required","messages","customValidationMessages","getViewModel","payload","errors","viewModel","formGroup","attributes"],"sources":["../../../../../src/server/plugins/engine/components/AutocompleteField.ts"],"sourcesContent":["import { type AutocompleteFieldComponent } from '@defra/forms-model'\n\nimport { SelectField } from '~/src/server/plugins/engine/components/SelectField.js'\nimport { messageTemplate } from '~/src/server/plugins/engine/pageControllers/validationOptions.js'\nimport {\n  type FormPayload,\n  type FormSubmissionError\n} from '~/src/server/plugins/engine/types.js'\n\nexport class AutocompleteField extends SelectField {\n  declare options: AutocompleteFieldComponent['options']\n\n  constructor(\n    def: AutocompleteFieldComponent,\n    props: ConstructorParameters<typeof SelectField>[1]\n  ) {\n    super(def, props)\n\n    const { options } = def\n    let { formSchema } = this\n\n    if (options.required !== false) {\n      const messages = options.customValidationMessages\n\n      formSchema = formSchema.messages({\n        'any.only': messages?.['any.only'] ?? messageTemplate.required,\n        'any.required': messages?.['any.required'] ?? messageTemplate.required\n      })\n    }\n\n    this.options = options\n    this.formSchema = formSchema\n  }\n\n  getViewModel(payload: FormPayload, errors?: FormSubmissionError[]) {\n    const viewModel = super.getViewModel(payload, errors)\n    let { formGroup } = viewModel\n\n    formGroup ??= {}\n    formGroup.attributes = {\n      'data-module': 'govuk-accessible-autocomplete'\n    }\n\n    return {\n      ...viewModel,\n      formGroup\n    }\n  }\n}\n"],"mappings":"AAEA,SAASA,WAAW;AACpB,SAASC,eAAe;AAMxB,OAAO,MAAMC,iBAAiB,SAASF,WAAW,CAAC;EAGjDG,WAAWA,CACTC,GAA+B,EAC/BC,KAAmD,EACnD;IACA,KAAK,CAACD,GAAG,EAAEC,KAAK,CAAC;IAEjB,MAAM;MAAEC;IAAQ,CAAC,GAAGF,GAAG;IACvB,IAAI;MAAEG;IAAW,CAAC,GAAG,IAAI;IAEzB,IAAID,OAAO,CAACE,QAAQ,KAAK,KAAK,EAAE;MAC9B,MAAMC,QAAQ,GAAGH,OAAO,CAACI,wBAAwB;MAEjDH,UAAU,GAAGA,UAAU,CAACE,QAAQ,CAAC;QAC/B,UAAU,EAAEA,QAAQ,GAAG,UAAU,CAAC,IAAIR,eAAe,CAACO,QAAQ;QAC9D,cAAc,EAAEC,QAAQ,GAAG,cAAc,CAAC,IAAIR,eAAe,CAACO;MAChE,CAAC,CAAC;IACJ;IAEA,IAAI,CAACF,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACC,UAAU,GAAGA,UAAU;EAC9B;EAEAI,YAAYA,CAACC,OAAoB,EAAEC,MAA8B,EAAE;IACjE,MAAMC,SAAS,GAAG,KAAK,CAACH,YAAY,CAACC,OAAO,EAAEC,MAAM,CAAC;IACrD,IAAI;MAAEE;IAAU,CAAC,GAAGD,SAAS;IAE7BC,SAAS,KAAK,CAAC,CAAC;IAChBA,SAAS,CAACC,UAAU,GAAG;MACrB,aAAa,EAAE;IACjB,CAAC;IAED,OAAO;MACL,GAAGF,SAAS;MACZC;IACF,CAAC;EACH;AACF","ignoreList":[]}